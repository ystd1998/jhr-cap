---
title: "Exploratory Analysis"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

This is exploratory analysis report of the SwiftKey Dataset from Coursera Data Science Capstone project. The purpose of the project is to help people have more friendly keyboard response when they are using their mobile devices for email, social networks and other activities. The project use the dataset to predict the next cadidates wors from the keyboard typing, so that it can help people for the fast typing.

## Loading the data set

```{r}

# load dataset using tm packages
library(tm)
data_path_en <- 'data/en_US'
corpus <- VCorpus(DirSource(directory=data_path_en, encoding = "UTF-8"), 
                           readerControl = list(language = "en"))

# display structure of corpus
# str(corpus)
```
## Summary of the data set

```{r}
# Blogs
text <- as.character(corpus[[1]])
blog_file_size <- object.size(text)
format(blog_file_size, units = "Mb") # size 248.5 Mb
blog_num_lines <- length(text) # has 899288 lines
text <- stri_flatten(text, collapse =" ")
text.words <- unlist(stri_extract_words(text, locale = "en"))
blog_num_words <- length(text.words) # 37541795 words
blog_uniq_wors <- length(unique(text.words)) # 395147 unique words

# News
text <- as.character(corpus[[2]])
news_file_size <- object.size(as.character(text))
format(news_file_size, units = "Mb") # size 196.3 Mb
news_num_lines <- length(text) # has 1010242 lines
text <- stri_flatten(text, collapse =" ")
text.words <- unlist(stri_extract_words(text, locale = "en"))
news_num_words <- length(text.words) # 34762303 words
news_uniq_words <- length(unique(text.words)) # 333177 unique words

# Tweets
text <- as.character(corpus[[3]])
twitter_file_size <- object.size(as.character(text))
format(twitter_file_size, units = "Mb") # size 159.4 Mb
twitter_num_lines <- length(text) # has 2360148 lines
text <- stri_flatten(text, collapse =" ")
text.words <- unlist(stri_extract_words(text, locale = "en"))
twitter_num_words <- length(text.words) # 30092866 words
twitter_uniq_words <- length(unique(text.words)) # 486373 unique words

### Helper function specific to this data frame
add_frame <- function(df, m1, m2, m3, m4, m5) {

    additional <- data.frame(File_Name = m1,
                    File_Size_MB = m2,
                    Number_of_lines = m3,
                    Number of Words = m4,
                    Unique Words = m5,
                    stringsAsFactors = FALSE
                    )
    df <- rbind(df, additional)
    return(df)
}

frame <- add_frame(NULL, "Blog", blog_file_size, blog_num_lines, blog_num_words, blog_uniq_wors)
frame <- add_frame(frame, "News", news_file_size, news_num_lines, news_num_words, news_uniq_words)
frame <- add_frame(frame, "Twitter", twitter_file_size, twitter_num_lines, twitter_num_words, twitter_uniq_words)

#Show the table output
datatable(frame, options = list(dom = 't'))
```



```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
